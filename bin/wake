#!/usr/bin/env python

import argparse
import multiprocessing
import os
import sys

scriptpath = os.path.dirname(os.path.realpath(__file__))
lib = scriptpath + "/../lib/"
sys.path.insert(0, lib)

sitepath = os.getcwd()
sys.path.insert(0, sitepath)

def main():
    parser = argparse.ArgumentParser()
    parser.add_argument("subcommand", nargs="?")
    parser.add_argument("-t", "--num-threads", nargs="?", type=int,
            default=multiprocessing.cpu_count())
    args = parser.parse_args()

    import wake.wake as wakelib
    if args.subcommand == 'up':
        wakelib.upload()
    else:
        wakelib.build(num_threads=args.num_threads)

if __name__ == "__main__":
    main()
